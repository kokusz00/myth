<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Callouts Display</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="header">
    <h1>Active Callouts</h1>
  </div>
  <div class="callouts-container">
    <div class="active-callouts"></div>
    <div class="waiting-callouts"></div>
  </div>

  <script src="shared.js"></script>
<script src="shared.js"></script>
<script>
  let previousActiveIds = [];

  function renderCallouts() {
    const activeContainer = document.querySelector(".active-callouts");
    const waitingContainer = document.querySelector(".waiting-callouts");
    const calloutSound = document.getElementById("calloutSound");

    if (calloutSound && !calloutSound.src.includes('callout.mp3')) {
      calloutSound.src = "sounds/callout.mp3";
    }

    const { activeCallouts, waitingCallouts } = getCallouts();

    const newIds = activeCallouts.map(c => c.id);
    const newActive = newIds.filter(id => !previousActiveIds.includes(id));
    if (newActive.length > 0 && calloutSound) {
      calloutSound.play().catch(() => {});
    }
    previousActiveIds = newIds;

    activeContainer.innerHTML = '<h2>Active</h2>' +
      activeCallouts.map(c => `<div class="callout">
        <strong>${c.user}</strong><br>
        ${c.channel} - ${c.time}
      </div>`).join('');

    waitingContainer.innerHTML = '<h2>Waiting</h2>' +
      waitingCallouts.map(c => `<div class="callout">
        <strong>${c.user}</strong><br>
        ${c.channel} - ${c.time}
      </div>`).join('');
  }

  setInterval(renderCallouts, 500);
  renderCallouts();
</script>

</body>
</html>
