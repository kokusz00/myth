<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="dark">
  <div class="admin-container">
    <h1>Callout Admin Panel</h1>

    <div class="form">
      <input type="text" id="user" placeholder="User" />
      <input type="text" id="channel" placeholder="Voice Channel" />
      <input type="text" id="time" placeholder="Time" />
      <select id="target">
        <option value="waiting">Send to Waiting</option>
        <option value="active">Send to Active</option>
      </select>
      <button onclick="addCallout()">Callout</button>
    </div>

    <div class="lists">
      <div>
        <h2>Active Callouts</h2>
        <ul id="activeList"></ul>
      </div>
      <div>
        <h2>Waiting Callouts</h2>
        <ul id="waitingList"></ul>
      </div>
    </div>
  </div>

  <script src="shared.js"></script>
  <script>
    const activeList = document.getElementById("activeList");
    const waitingList = document.getElementById("waitingList");

    function renderLists() {
      const { activeCallouts, waitingCallouts } = getCallouts();

      activeList.innerHTML = "";
      activeCallouts.forEach((c, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          ${c.user} - ${c.channel} - ${c.time}
          <button onclick="moveCallout('active', ${i}, 'waiting')">⏩</button>
          <button onclick="removeCallout('active', ${i})">❌</button>`;
        activeList.appendChild(li);
      });

      waitingList.innerHTML = "";
      waitingCallouts.forEach((c, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          ${c.user} - ${c.channel} - ${c.time}
          <button onclick="moveCallout('waiting', ${i}, 'active')">⏩</button>
          <button onclick="removeCallout('waiting', ${i})">❌</button>`;
        waitingList.appendChild(li);
      });
    }

    function addCallout() {
      const user = document.getElementById("user").value;
      const channel = document.getElementById("channel").value;
      const time = document.getElementById("time").value;
      const target = document.getElementById("target").value;

      if (!user || !channel || !time) return alert("Please fill all fields");

      const callouts = JSON.parse(localStorage.getItem("callouts") || "{}");
      callouts[target] = callouts[target] || [];
      callouts[target].push({ id: Date.now(), user, channel, time });
      localStorage.setItem("callouts", JSON.stringify(callouts));
      renderLists();
    }

    function removeCallout(type, index) {
      const callouts = JSON.parse(localStorage.getItem("callouts") || "{}");
      callouts[type].splice(index, 1);
      localStorage.setItem("callouts", JSON.stringify(callouts));
      renderLists();
    }

    function moveCallout(from, index, to) {
      const callouts = JSON.parse(localStorage.getItem("callouts") || "{}");
      const [moved] = callouts[from].splice(index, 1);
      callouts[to] = callouts[to] || [];
      callouts[to].push(moved);
      localStorage.setItem("callouts", JSON.stringify(callouts));
      renderLists();
    }

    renderLists();
    setInterval(renderLists, 1000);
  </script>
</body>
</html>
